<h3>基于JQuery的ajax方法的二次封装</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;首先说明一点，我并不是专业的前端开发攻城狮，所以，这篇文章的水平，可能比较低，里面的一些观点，可能比较可笑，如果疏漏或错误的地方，希望大家不吝赐教，谢谢！</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;现在比较流行的开发模式是，后台只提供接口，客户端调用接口获取数据，然后做渲染。在H5里，我采用的是Jquery提供的ajax方法来完成数据加载的，抛弃了类似jsp这样的后端渲染方案。JQuery提供的ajax方法，其实已经比较简单了，但为什么还要做二次开发呢？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;项目刚开始的时候，感觉JQuery提供的ajax方法，已经比较简单了，所以，没考虑太多，直接用JQuery提供的ajax方法来写。但到了项目大概进行了一半的时候，发现很多请求方法，代码有很多都是重复，但此时我并未意识到应该做些什么改变，直到一天，后台接口发现所有的请求，都缺少一个关键参数，此时，我才懵了。我写的ajax方法，得一个一个手动去添加这个关键参数。然后，我想到了一点，如果下次再发现需要改动，该怎么办呢？难道我再一次去一个一个手动修改吗？能不能想个简单的办法，如果有统一改动，我只需要修改一处或两处地方，就完成了修改呢？此时，我想起了在做android开发中，经常会做一些二次封装，只需要在一处或两处地方控制一下，就可以做到全部修改过来。基于这个想法，我想尝试一下，可以不可以对ajax做二次封装呢？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;由于是基于JQuery的ajax方法的二次封装，其方法主体，还是JQuery的ajax方法，我要做的是对出口和入口，做一些统一处理，比如：添加一些统一的请求参数，对响应异常，做一下异常的统一处理。我在封装方法里，在请求开始前，显示loading效果，在请求结束后，不管成功与否，都结束掉loading效果。那么，在我的所有请求里，都会有一个统一的loading效果。在请求Header里，统一添加所需的请求头参数，也可以在data里，添加统一的请求参数；在响应方法里，除了结束掉loading效果外，我还对返回的json数据，做了一次统一处理，而不是在业务层每个接口里去单独处理......由于各个项目的实际需求不同，所以，每个项目对ajax的封装，可能不会完全一致，但都差不多，具体封装需根据具体业务需求来完成，另附上我的代码片段：</p>
<img src="https://github.com/cily-code/H5/blob/master/20170102142749561.png">
<p>也许已经有了大牛做了这样的工作了，但由于我的技术水平不足以拜读其大作，所以，这篇文章没有参考其他的文章，是被实际的业务需求给逼出来的。假如没有业务变更，估计我也想不到做这样的工作，但不管如何，这也是一次成功的尝试。如果有更好的方案，欢迎一起讨论，谢谢！</p>
